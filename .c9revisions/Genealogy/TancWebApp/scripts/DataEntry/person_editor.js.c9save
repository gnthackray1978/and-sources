{"ts":1354634934454,"silentsave":true,"restoring":false,"patch":[[{"diffs":[[1,"﻿\n$(document).ready(function () {\n    var jsMaster = new JSMaster();\n    var ancPersonEditor = new AncPersonEditor();\n\n    jsMaster.generateHeader('#1', function () {\n        ancPersonEditor.init();\n\n    });\n\n});\n\n\n\n\n\nvar AncPersonEditor = function () {\n    this.qryStrUtils = new QryStrUtils();\n    this.ancUtils = new AncUtils();\n    \n    this.postParams = {\n\n        url: '',\n        data: '',\n        idparam: 'id',\n        refreshmethod: this.load,\n        refreshArgs: undefined,\n        Context: this\n    };\n}\n\nAncPersonEditor.prototype = {\n\n    init: function () {\n\n\n        var panels = new Panels();\n\n        $(\"#save\").live(\"click\", $.proxy(function () { this.save(); return false; }, this));\n        $(\"#return\").live(\"click\", $.proxy(function () { this.saveReturn(); return false; }, this));\n        $(\"#main\").live(\"click\", $.proxy(function () { panels.sourcesShowPanel('1'); return false; }, panels));\n        $(\"#more\").live(\"click\", $.proxy(function () { panels.sourcesShowPanel('2'); return false; }, panels));\n        this.load();\n        return false;\n    },\n\n    load: function () {\n        var params = {};\n        params[0] = this.qryStrUtils.getParameterByName('id', '');\n\n        this.ancUtils.twaGetJSON(\"/GetPerson/Select\", params, $.proxy(this.processData, this));\n    },\n\n\n    processData: function (data) {\n        $('#txtNam').val(data.ChristianName);\n        $('#txtSur').val(data.Surname);\n        $('#txtFatNam').val(data.FatherChristianName);\n        $('#txtFatSur').val(data.FatherSurname);\n        $('#txtMotNam').val(data.MotherChristianName);\n        $('#txtMotSur').val(data.MotherSurname);\n        $('#txtBirDat').val(data.Birth);\n        $('#txtBapDat').val(data.Baptism);\n        $('#txtBirPar').val(data.BirthLocation);\n        $('#txtBirCny').val(data.BirthCounty);\n        $('#txtSrc').val(data.SourceDescription);\n        $('#txtRef').val(data.ReferenceLocation);\n        $('#txtRefDat').val(data.ReferenceDate);\n        $('#txtSNam').val(data.SpouseChristianName);\n        $('#txtSSur').val(data.SpouseSurname);\n        $('#txtFOcc').val(data.FatherOccupation);\n        $('#txtOcc').val(data.Occupation);\n        $('#txtDetDat').val(data.Death);\n        $('#txtDetPar').val(data.DeathLocation);\n        $('#txtDetCny').val(data.DeathCounty);\n        $('#txtNotRdOnly').val(data.Notes);\n\n        this.qryStrUtils.updateQryPar('source_ids', data.Sources);\n\n\n\n        var ancSelectorSources = new AncSelectorSources();\n\n        ancSelectorSources.getSources('#sourceselector');\n\n    },\n    GetPersonRecord: function () {\n        var data = {};\n        data.personId = this.qryStrUtils.getParameterByName('id', '');\n        data.sources = this.qryStrUtils.getParameterByName('source_ids', '');\n        data.christianName = $('#txtNam').val();\n        data.surname = $('#txtSur').val();\n        data.fatherchristianname = $('#txtFatNam').val();\n        data.fathersurname = $('#txtFatSur').val();\n        data.motherchristianname = $('#txtMotNam').val();\n        data.mothersurname = $('#txtMotSur').val();\n        data.datebirthstr = $('#txtBirDat').val();\n        data.datebapstr = $('#txtBapDat').val();\n        data.birthloc = $('#txtBirPar').val();\n        data.birthcounty = $('#txtBirCny').val();\n        data.source = $('#txtSrc').val();\n        data.refloc = $('#txtRef').val();\n        data.refdate = $('#txtRefDat').val();\n        data.spousechristianname = $('#txtSNam').val();\n        data.spousesurname = $('#txtSSur').val();\n        data.fatheroccupation = $('#txtFOcc').val();\n        data.occupation = $('#txtOcc').val();\n        data.datedeath = $('#txtDetDat').val();\n        data.deathloc = $('#txtDetPar').val();\n        data.deathcounty = $('#txtDetCny').val();\n        data.notes = $('#txtNotRdOnly').val();\n\n        return data;\n\n\n    },\n    save: function () {\n        this.postParams.url = '/Person/Add';\n        this.postParams.data = this.GetPersonRecord();\n        this.ancUtils.twaPostJSON(this.postParams);\n    },\n\n    saveReturn: function () {             \n        this.postParams.refreshmethod = function () { window.location = '../HtmlPages/PersonSearch.html' + window.location.hash; };\n        this.postParams.url = '/Person/Add';\n        this.postParams.data = this.GetPersonRecord();\n        this.ancUtils.twaPostJSON(this.postParams);\n    }\n \n}\n\n\n\n \n "]],"start1":0,"start2":0,"length1":0,"length2":4332}]],"length":4332}
{"contributors":[],"silentsave":false,"ts":1354634997965,"patch":[[{"diffs":[[-1,"﻿"],[1,"var JSMaster, QryStrUtils, AncUtils, AncSelectorSources, Panels;\n"],[0,"\n$(d"]],"start1":0,"start2":0,"length1":5,"length2":69},{"diffs":[[0,";\n\n});\n\n"],[-1,"\n\n\n\n"],[0,"var AncP"]],"start1":270,"start2":270,"length1":20,"length2":16},{"diffs":[[0,"    };\n}"],[1,";"],[0,"\n\nAncPer"]],"start1":568,"start2":568,"length1":16,"length2":17}]],"length":4393,"saved":false}
