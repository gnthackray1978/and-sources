{"ts":1354635004863,"silentsave":true,"restoring":false,"patch":[[{"diffs":[[1,"﻿\n\n\n\n\n\n$(document).ready(function () {\n    var jsMaster = new JSMaster();\n    var ancSourceEditor = new AncSourceEditor();\n\n    jsMaster.generateHeader('#1', function () {\n        ancSourceEditor.init();\n\n    });\n\n});\n\n\n\n\n\nvar AncSourceEditor = function () {\n    this.qryStrUtils = new QryStrUtils();\n    this.ancUtils = new AncUtils();\n    this.ancSelectorParishs = new AncSelectorParishs();\n    this.ancSelectorSourceTypes = new AncSelectorSourceTypes();\n\n    this.postParams = {\n\n        url: '',\n        data: '',\n        idparam: 'id',\n        refreshmethod: this.load,\n        refreshArgs: undefined,\n        Context: this\n    };\n}\n\nAncSourceEditor.prototype = {\n\n   init :function() {\n\n       var panels = new Panels();\n\n       $(\"#save\").live(\"click\", $.proxy(function () { this.save(); return false; }, this));\n       $(\"#return\").live(\"click\", $.proxy(function () { this.saveReturn(); return false; }, this));\n       $(\"#main\").live(\"click\", $.proxy(function () { panels.sourcesShowPanel('1'); return false; }, panels));\n       $(\"#notes\").live(\"click\", $.proxy(function () { panels.sourcesShowPanel('2'); return false; }, panels));\n       $(\"#files\").live(\"click\", $.proxy(function () { panels.sourcesShowPanel('2'); return false; }, panels));\n\n       this.load();\n\n       return false;\n\n   },\n\n   load: function(){\n       var params = {};\n       params[0] = this.qryStrUtils.getParameterByName('id', '');\n\n       this.ancUtils.twaGetJSON(\"/Sources/GetSource\", params, $.proxy(this.processData, this));\n   },\n\n   processData: function(data) {\n\n    // public string AddPerson(string personId, string birthparishId,string deathparishId, string referenceparishId, string ismale, string years, string months, string weeks, string days)\n\n        $('#txtSourceRef').val(data.SourceRef);\n        $('#txtSourceDescription').val(data.SourceDesc);\n\n        $('#txtLowerDate').val(data.SourceDateStr);\n        $('#txtUpperDate').val(data.SourceDateStrTo);\n        $('#txtOriginalLoc').val(data.OriginalLocation);\n\n\n        $('#txtNotRdOnly').val(data.SourceNotes);\n\n        if (data.IsCopyHeld == false) {\n            $('#chkIsCopyHeld').prop('checked', false);\n        }\n        else {\n            $('#chkIsCopyHeld').prop('checked', true);\n        }\n\n\n        if (data.IsViewed == false) {\n            $('#chkIsViewed').prop('checked', false);\n        }\n        else {\n            $('#chkIsViewed').prop('checked', true);\n        }\n\n\n        if (data.IsThackrayFound == false) {\n            $('#chkIsThackrayFound').prop('checked', false);\n        }\n        else {\n            $('#chkIsThackrayFound').prop('checked', true);\n        }\n\n        this.qryStrUtils.updateQryPar('stypes', data.SourceTypes);\n\n        this.qryStrUtils.updateQryPar('pids', data.Parishs);\n\n        this.qryStrUtils.updateQryPar('fids', data.FileIds);\n\n\n\n        this.ancSelectorParishs.init('#parishselector');\n\n        this.ancSelectorSourceTypes.getSourceTypes('#sourcetypeselector');\n\n    },\n    GetSourceRecord:function (rowIdx) {\n        var data = {};\n        //data.personId = getParameterByName('id');\n\n        //data.sources = getParameterByName('source_ids');\n\n        data.sourceRef = $('#txtSourceRef').val();\n        data.sourceDesc = $('#txtSourceDescription').val();\n        data.sourceDateStr = $('#txtLowerDate').val();\n        data.sourceDateStrTo = $('#txtUpperDate').val();\n        data.sourceNotes =$('#txtNotes').val();\n        data.originalLocation = $('#txtOriginalLoc').val();\n\n\n        data.isCopyHeld = $('#chkIsCopyHeld').prop('checked');\n        data.isViewed = $('#chkIsViewed').prop('checked');\n        data.isThackrayFound = $('#chkIsThackrayFound').prop('checked');\n\n\n\n        data.parishs = this.qryStrUtils.getParameterByName('pids', '');\n        data.sourceTypes = this.qryStrUtils.getParameterByName('stypes', '');\n        data.fileIds = this.qryStrUtils.getParameterByName('fids', '');\n\n        return data;\n\n\n    }\n\n\n}\n\n\n\n\n\n\n\n\n\n\n\n\n//$(document).ready(function () {\n\n\n\n//    createHeader('#1',getSource);\n//   \n//});\n\n\n//save = function () {\n//    var serviceSource = GetSourceRecord();\n\n//    saveSource(serviceSource);\n\n//}\n\n\n\n//saveReturn = function () {\n\n////    var serviceSource = GetSourceRecord();\n////    var localurl = getHost() + '/Sources/Add';\n\n////    var stringy = JSON.stringify(serviceSource);\n\n////    $.ajax({\n////        cache: false,\n////        type: \"POST\",\n////        async: false,\n////        url: localurl,\n////        data: stringy,\n////        contentType: \"application/json\",\n////        dataType: \"json\",\n////        success: function (message) {\n////            handleReturnCodeWithReturn(message, '../HtmlPages/SourceSearch.html', 'id')            \n////        }\n\n////    });\n\n\n//    twaPostJSON('/Sources/Add', GetSourceRecord(), '../HtmlPages/SourceSearch.html', 'id');\n\n//}\n\n\n\n//saveSource = function (serviceSource) {\n\n////    var localurl = getHost() + '/Sources/Add';\n\n////    var stringy = JSON.stringify(serviceSource);\n\n////    $.ajax({\n////        cache: false,\n////        type: \"POST\",\n////        async: false,\n////        url: localurl,\n////        data: stringy,\n////        contentType: \"application/json\",\n////        dataType: \"json\",\n////        success: function (message) {           \n////            handleReturnCode(message, 'id');  \n////        }\n\n//    //    });\n\n//    twaPostJSON('/Sources/Add', serviceSource, '', 'id');\n//}\n\n\n//function getSource() {\n\n//    var params = {};\n\n//   // var url = getHost() + \"/Sources/GetSource\";\n\n//    var id = getParameterByName('id', '');\n\n//    params[0] = id;\n\n////    $.ajaxSetup({ cache: false });\n////    $.getJSON(url, params, processData);\n\n//    twaGetJSON(\"/Sources/GetSource\", params, processData);\n\n//    return false;\n//}\n\n\n//function processData(data) {\n\n//    // public string AddPerson(string personId, string birthparishId,string deathparishId, string referenceparishId, string ismale, string years, string months, string weeks, string days)\n\n//    $('#txtSourceRef').val(data.SourceRef);\n//    $('#txtSourceDescription').val(data.SourceDesc);\n\n//    $('#txtLowerDate').val(data.SourceDateStr);\n//    $('#txtUpperDate').val(data.SourceDateStrTo);\n//    $('#txtOriginalLoc').val(data.OriginalLocation);\n\n\n//    $('#txtNotRdOnly').val(data.SourceNotes);\n\n//    if (data.IsCopyHeld == false) {\n//        $('#chkIsCopyHeld').prop('checked', false);\n//    }\n//    else {\n//        $('#chkIsCopyHeld').prop('checked', true);\n//    }\n\n\n//    if (data.IsViewed == false) {\n//        $('#chkIsViewed').prop('checked', false);\n//    }\n//    else {\n//        $('#chkIsViewed').prop('checked', true);\n//    }\n\n\n//    if (data.IsThackrayFound == false) {\n//        $('#chkIsThackrayFound').prop('checked', false);\n//    }\n//    else {\n//        $('#chkIsThackrayFound').prop('checked', true);\n//    }\n\n//    updateQryPar('stypes', data.SourceTypes);\n\n//    updateQryPar('pids', data.Parishs);\n\n//    updateQryPar('fids', data.FileIds);\n\n//    getParishs('#parishselector');\n\n//    getSourceTypes('#sourcetypeselector');\n//}\n\n\n\n//GetSourceRecord = function (rowIdx) {\n//    var data = {};\n//    //data.personId = getParameterByName('id');\n\n//    //data.sources = getParameterByName('source_ids');\n\n//    data.sourceRef = $('#txtSourceRef').val();\n//    data.sourceDesc = $('#txtSourceDescription').val();\n//    data.sourceDateStr = $('#txtLowerDate').val();\n//    data.sourceDateStrTo = $('#txtUpperDate').val();\n//    data.sourceNotes =$('#txtNotes').val();\n//    data.originalLocation = $('#txtOriginalLoc').val();\n\n\n//    data.isCopyHeld = $('#chkIsCopyHeld').prop('checked');\n//    data.isViewed = $('#chkIsViewed').prop('checked');\n//    data.isThackrayFound = $('#chkIsThackrayFound').prop('checked');\n\n\n\n//    data.parishs = getParameterByName('pids', '');\n//    data.sourceTypes = getParameterByName('stypes', '');\n//    data.fileIds = getParameterByName('fids', '');\n\n//    return data;\n\n\n//}"]],"start1":0,"start2":0,"length1":0,"length2":7916}]],"length":7916}
{"contributors":[],"silentsave":false,"ts":1354635094534,"patch":[[{"diffs":[[-1,"﻿\n\n\n\n"],[1,"\nvar JSMaster, QryStrUtils, AncUtils,AncSelectorParishs,AncSelectorSourceTypes,Panels;"],[0,"\n\n$("]],"start1":0,"start2":0,"length1":9,"length2":90},{"diffs":[[0,";\n\n});\n\n"],[-1,"\n\n\n\n"],[0,"var AncS"]],"start1":292,"start2":292,"length1":20,"length2":16},{"diffs":[[0,"ta.IsCopyHeld =="],[-1,""],[0,""],[1,"="],[0," false) {\n      "]],"start1":2157,"start2":2157,"length1":32,"length2":33},{"diffs":[[0,"data.IsViewed =="],[-1,""],[0,""],[1,"="],[0," false) {\n      "]],"start1":2344,"start2":2344,"length1":32,"length2":33},{"diffs":[[0,"ThackrayFound =="],[-1,""],[0,""],[1,"="],[0," false) {\n      "]],"start1":2534,"start2":2534,"length1":32,"length2":33},{"diffs":[[0,".val();\n"],[-1,"\n\n"],[0,"        "]],"start1":3552,"start2":3552,"length1":18,"length2":16},{"diffs":[[0,"cked');\n"],[-1,"\n\n\n"],[0,"        "]],"start1":3747,"start2":3747,"length1":19,"length2":16},{"diffs":[[0,"fids', '');\n"],[-1,"\n"],[0,"        retu"]],"start1":3965,"start2":3965,"length1":25,"length2":24},{"diffs":[[0,"ta;\n"],[-1,"\n\n"],[0,"    }\n"],[-1,"\n\n}\n\n\n\n\n\n\n\n\n\n\n\n\n//$(document).ready(function () {\n\n\n\n//    createHeader('#1',getSource);\n//   \n//});\n\n\n//save = function () {\n//    var serviceSource = GetSourceRecord();\n\n//    saveSource(serviceSource);\n\n//}\n\n\n\n//saveReturn = function () {\n\n////    var serviceSource = GetSourceRecord();\n////    var localurl = getHost() + '/Sources/Add';\n\n////    var stringy = JSON.stringify(serviceSource);\n\n////    $.ajax({\n////        cache: false,\n////        type: \"POST\",\n////        async: false,\n////        url: localurl,\n////        data: stringy,\n////        contentType: \"application/json\",\n////        dataType: \"json\",\n////        success: function (message) {\n////            handleReturnCodeWithReturn(message, '../HtmlPages/SourceSearch.html', 'id')            \n////        }\n\n////    });\n\n\n//    twaPostJSON('/Sources/Add', GetSourceRecord(), '../HtmlPages/SourceSearch.html', 'id');\n\n//}\n\n\n\n//saveSource = function (serviceSource) {\n\n////    var localurl = getHost() + '/Sources/Add';\n\n////    var stringy = JSON.stringify(serviceSource);\n\n////    $.ajax({\n////        cache: false,\n////        type: \"POST\",\n////        async: false,\n////        url: localurl,\n////        data: stringy,\n////        contentType: \"application/json\",\n////        dataType: \"json\",\n////        success: function (message) {           \n////            handleReturnCode(message, 'id');  \n////        }\n\n//    //    });\n\n//    twaPostJSON('/Sources/Add', serviceSource, '', 'id');\n//}\n\n\n//function getSource() {\n\n//    var params = {};\n\n//   // var url = getHost() + \"/Sources/GetSource\";\n\n//    var id = getParameterByName('id', '');\n\n//    params[0] = id;\n\n////    $.ajaxSetup({ cache: false });\n////    $.getJSON(url, params, processData);\n\n//    twaGetJSON(\"/Sources/GetSource\", params, processData);\n\n//    return false;\n//}\n\n\n//function processData(data) {\n\n//    // public string AddPerson(string personId, string birthparishId,string deathparishId, string referenceparishId, string ismale, string years, string months, string weeks, string days)\n\n//    $('#txtSourceRef').val(data.SourceRef);\n//    $('#txtSourceDescription').val(data.SourceDesc);\n\n//    $('#txtLowerDate').val(data.SourceDateStr);\n//    $('#txtUpperDate').val(data.SourceDateStrTo);\n//    $('#txtOriginalLoc').val(data.OriginalLocation);\n\n\n//    $('#txtNotRdOnly').val(data.SourceNotes);\n\n//    if (data.IsCopyHeld == false) {\n//        $('#chkIsCopyHeld').prop('checked', false);\n//    }\n//    else {\n//        $('#chkIsCopyHeld').prop('checked', true);\n//    }\n\n\n//    if (data.IsViewed == false) {\n//        $('#chkIsViewed').prop('checked', false);\n//    }\n//    else {\n//        $('#chkIsViewed').prop('checked', true);\n//    }\n\n\n//    if (data.IsThackrayFound == false) {\n//        $('#chkIsThackrayFound').prop('checked', false);\n//    }\n//    else {\n//        $('#chkIsThackrayFound').prop('checked', true);\n//    }\n\n//    updateQryPar('stypes', data.SourceTypes);\n\n//    updateQryPar('pids', data.Parishs);\n\n//    updateQryPar('fids', data.FileIds);\n\n//    getParishs('#parishselector');\n\n//    getSourceTypes('#sourcetypeselector');\n//}\n\n\n\n//GetSourceRecord = function (rowIdx) {\n//    var data = {};\n//    //data.personId = getParameterByName('id');\n\n//    //data.sources = getParameterByName('source_ids');\n\n//    data.sourceRef = $('#txtSourceRef').val();\n//    data.sourceDesc = $('#txtSourceDescription').val();\n//    data.sourceDateStr = $('#txtLowerDate').val();\n//    data.sourceDateStrTo = $('#txtUpperDate').val();\n//    data.sourceNotes =$('#txtNotes').val();\n//    data.originalLocation = $('#txtOriginalLoc').val();\n\n\n//    data.isCopyHeld = $('#chkIsCopyHeld').prop('checked');\n//    data.isViewed = $('#chkIsViewed').prop('checked');\n//    data.isThackrayFound = $('#chkIsThackrayFound').prop('checked');\n\n\n\n//    data.parishs = getParameterByName('pids', '');\n//    data.sourceTypes = getParameterByName('stypes', '');\n//    data.fileIds = getParameterByName('fids', '');\n\n//    return data;\n\n\n//"],[0,"}"],[1,";"]],"start1":3994,"start2":3994,"length1":3996,"length2":12}]],"length":4006,"saved":false}
