{"ts":1354536198413,"silentsave":true,"restoring":false,"patch":[[{"diffs":[[1,"ï»¿\n\n\nvar AncSelectorParishs = function () {\n    this.qryStrUtils = new QryStrUtils();\n    this.ancUtils = new AncUtils();\n    this.ancSelectorBase = new AncSelectorBase()\n\n    this.url = \"/Parishs/GetParishs/Select\"; // getHost() + \n\n    this.ancSelectorBase.context_data = {\n        editorUrl: '../HtmlPages/ParishEditor.html',\n        param_name: 'pids',\n        selectionUrl: '/Parishs/GetParishNames',\n        pagerfunction: this.getParishLink,   // this.pagerfunction = 'getLink';\n        search_body: 'p_search_bdy',\n        search_hed: 'p_search_hed',\n        pager: 'p_pager',\n        sourceRefId: 'txtParishRef',\n        title: 'PARISHS',\n        refreshMethod: this.getParishs,\n        parentContext: this\n    };\n\n}\n\n\nAncSelectorParishs.prototype = {\n\n    init: function(selectorid) {\n\n        var params = {};\n\n        if (selectorid != undefined) {\n            this.ancSelectorBase.createOutline(selectorid)\n        }\n\n        var parishName = $('#' + this.ancSelectorBase.context_data.sourceRefId).val();\n\n        if (parishName == '') parishName = '%';\n\n        params[0] = '%';//deposited\n        params[1] = parishName;\n        params[2] = '%';//county\n        params[3] = this.qryStrUtils.getParameterByName('p_page', 0);\n        params[4] = '10';\n        params[5] = 'ParishName'; //sort column\n\n        var success = function (data) {\n            var batch_data = {};\n\n            batch_data.Batch = data.Batch;\n            batch_data.BatchLength = data.BatchLength;\n            batch_data.Total = data.Total;\n            batch_data.rows = new Array();\n\n            $.each(data.serviceParishs, function (source, sourceInfo) {\n                var row0 = { id: sourceInfo.ParishId, ref: sourceInfo.ParishName };\n                batch_data.rows.push(row0);\n            });\n\n            this.ancSelectorBase.createBody(batch_data);\n        };\n\n        this.ancUtils.twaGetJSON(this.url, params, $.proxy(success, this));\n\n        return false;\n    },\n\n    getParishLink: function(toPage) {\n\n        this.qryStrUtils.updateQryPar('p_page', toPage);\n        this.init();\n\n    }\n\n\n\n}\n\n\n\n\n//var rows = new Array();\n// \n\n//function getParishLink(toPage) {\n\n//    updateQryPar('p_page', toPage);\n//    getParishs();\n\n//}\n\n\n//function getParishs(selectorid) {\n\n//    var rows = new Array();\n//    var param_name = 'pids';\n//    var selectionUrl = '/Parishs/GetParishNames';\n//    var editorUrl = '../HtmlPages/ParishEditor.html';\n//    var sourceRefId = 'txtParishRef';\n//    var url = \"/Parishs/GetParishs/Select\";\n//    \n//    var pagerfunction = 'getParishLink';\n//    var getfunction = 'getParishs';\n\n//    var search_hed = 'p_search_hed';\n//    var search_body = 'p_search_bdy';\n\n//    var pager = 'p_pager';\n\n\n\n//    var params = {};\n\n//    var page = getParameterByName('p_page');\n//    if (!page || isNaN(page))\n//        page = 0;\n\n\n//    if (selectorid != undefined) {\n\n//        var body = createOutline(getfunction,search_hed, search_body, sourceRefId, \"PARISHS\", pager);\n\n//        $(selectorid).html(body);\n//    }\n\n//    var parishName = $('#' + sourceRefId).val();\n\n//    if (parishName == '') parishName = '%';\n\n//    params[0] = '%';//deposited\n//    params[1] = parishName;\n//    params[2] = '%';//county\n//    params[3] = String(page);\n//    params[4] = '10';\n//    params[5] = 'ParishName'; //sort column\n\n\n//   // $.ajaxSetup({ cache: false });\n\n\n\n//   // $.getJSON(url, params, function (data) {\n//    twaGetJSON(url, params, function (data) {\n\n//        var batch_data = {};\n//        batch_data.Batch = data.Batch;\n//        batch_data.BatchLength = data.BatchLength;\n//        batch_data.Total = data.Total;\n\n//        $.each(data.serviceParishs, function (source, sourceInfo) {\n//            var row0 = { id: sourceInfo.ParishId, ref: sourceInfo.ParishName };\n//            rows.push(row0);\n//        });\n\n//        createBody(rows, batch_data, editorUrl, param_name, selectionUrl, pagerfunction, search_body, search_hed,pager);\n//    });\n\n//    return false;\n//}\n\n"]],"start1":0,"start2":0,"length1":0,"length2":3998}]],"length":3998}
