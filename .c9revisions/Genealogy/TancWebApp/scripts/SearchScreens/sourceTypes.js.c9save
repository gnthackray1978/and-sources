{"ts":1354550320399,"silentsave":true,"restoring":false,"patch":[[{"diffs":[[1,"﻿$(document).ready(function () {\n    var jsMaster = new JSMaster();\n    var ancSourceTypes = new AncSourceTypes();\n    jsMaster.generateHeader('#1', function () {\n        ancSourceTypes.init();\n    });\n});\n\n\nvar AncSourceTypes = function () {\n    this.qryStrUtils = new QryStrUtils();\n    this.ancUtils = new AncUtils();\n    this.selection = new Array();\n  \n    this.postParams = {\n        url: '',\n        data: '',\n        idparam: undefined,\n        refreshmethod: this.getSourceTypes,\n        refreshArgs: ['1'],\n        Context: this\n    };\n}\n\n\n\nAncSourceTypes.prototype = {\n\n    init: function () {\n        var isActive = this.qryStrUtils.getParameterByName('active', '');\n        \n        var panels = new Panels();\n\n        $(\"#main\").live(\"click\", $.proxy(function () { panels.sourcesShowPanel('1'); return false; }, panels));\n        $(\"#more\").live(\"click\", $.proxy(function () { panels.sourcesShowPanel('2'); return false; }, panels));\n        $(\"#refresh\").live(\"click\", $.proxy(function () { this.getSourceTypes(); return false; }, this));\n\n        $(\"#add\").live(\"click\", $.proxy(function () { this.AddSourceType(); return false; }, this));\n        $(\"#delete\").live(\"click\", $.proxy(function () { this.DeleteRecord(); return false; }, this));\n\n        $(\"#stdesc\").live(\"click\", $.proxy(function () { this.sort('SourceTypeDesc'); return false; }, this));\n\n        if (isActive == '1') {\n            $('#txtDescription').val(this.qryStrUtils.getParameterByName('stdesc', ''));\n\n\n            this.getSourceTypes('1');\n        }\n    },\n    createQryString: function(page) {\n         \n        var args = {\n            \"active\": '1',\n            \"stdesc\": $('#txtDescription') \n        };\n\n        this.qryStrUtils.updateQry(args);\n    },\n    getSourceTypes: function(showdupes) {\n\n        var params = {};\n\n        params[0] = String($('#txtDescription').val());\n        params[1] = String(this.qryStrUtils.getParameterByName('page', 0));\n        params[2] = '30';\n        params[3] = String(this.qryStrUtils.getParameterByName('sort_col', 'SourceTypeDesc'));\n\n        this.ancUtils.twaGetJSON('/SourceTypes/Select', params, $.proxy(this.processData, this));\n        \n        this.createQryString(page);\n\n        return false;\n    },\n\n    processData: function(data) {\n        //alert('received something');\n        var tableBody = '';\n        var tableBody = '';\n        var selectEvents = new Array();\n        var _idx = 0;\n        var that = this;\n\n\n\n        $.each(data.serviceSources, function (source, sourceInfo) {\n            //<a href='' class=\"button\" ><span>Main</span></a>\n            var hidPID = '<input type=\"hidden\" name=\"SourceTypeId\" id=\"SourceTypeId\" value =\"' + sourceInfo.TypeId + '\"/>';\n\n\n            var arIdx = jQuery.inArray(sourceInfo.TypeId, selection);\n\n            if (arIdx >= 0) {\n                tableBody += '<tr class = \"highLightRow\">' + hidPID + hidParID;\n            }\n            else {\n                tableBody += '<tr>' + hidPID;\n            }\n\n            var _loc = window.location.hash;\n            _loc = that.qryStrUtils.updateStrForQry(_loc, 'id', sourceInfo.TypeId);\n\n            tableBody += '<td><a id= \"s' + _idx + '\" href=\"\" ><div>' + sourceInfo.Description + '</div></a></td>';\n            selectEvents.push({ key: 's' + _idx, value: sourceInfo.TypeId });\n\n            tableBody += '<td><div>' + sourceInfo.Order + '</div></td>';\n            tableBody += '<td><a href=\"../HtmlPages/SourceTypeEditor.html' + _loc + '\"><div> Edit </div></a></td>';\n\n            tableBody += '</tr>';\n        });\n\n        if (tableBody != '') {\n\n            $('#search_bdy').html(tableBody);\n            //create pager based on results\n\n\n            var pagerparams = { ParentElement: 'pager',\n                Batch: data.Batch,\n                BatchLength: data.BatchLength,\n                Total: data.Total,\n                Function: this.getLink,\n                Context: this\n            };\n\n            this.ancUtils.createpager(pagerparams);\n\n            //$('#pager').html(createpager(data.Batch, data.BatchLength, data.Total, 'getLink'));\n\n            $('#reccount').html(data.Total + ' Source Types');\n        }\n        else {\n\n            $('#search_bdy').html(tableBody);\n            $('#reccount').html('0 Source Types');\n        }\n\n        this.ancUtils.addlinks(selectEvents, this.processSelect, this);\n    },\n    processSelect: function (evt) {\n        this.ancUtils.handleSelection(evt, this.selection, '#search_bdy tr', \"#SourceTypeId\");\n    },\n    sort: function (sort_col) {\n        this.ancUtils.sort_inner(sort_col);\n        this.getSourceTypes();\n    },\n    getLink: function(toPage) {\n        this.qryStrUtils.updateQryPar('page', toPage);\n        this.getSourceTypes();\n    },\n    DeleteRecord: function () {\n        this.postParams.url = '/SourceTypes/Delete';\n        this.postParams.data = { sourceIds: this.ancUtils.convertToCSV(this.selection) };\n        this.ancUtils.twaPostJSON(this.postParams);\n    },\n    AddParish: function () {\n        window.location.href = '../HtmlPages/SourceTypeEditor.html#' + this.qryStrUtils.makeIdQryString('id', '0');\n    }\n\n}\n\n\n"]],"start1":0,"start2":0,"length1":0,"length2":5137}]],"length":5137}
{"contributors":[],"silentsave":false,"ts":1354550441111,"patch":[[{"diffs":[[-1,"﻿"],[1,"var JSMaster, QryStrUtils, AncUtils,Panels;\n\n\n"],[0,"$(do"]],"start1":0,"start2":0,"length1":5,"length2":50},{"diffs":[[0,"ction = "],[-1,"new Array()"],[1,"[]"],[0,";\n  \n   "]],"start1":379,"start2":379,"length1":27,"length2":18},{"diffs":[[0,"unction("],[-1,"page"],[0,""],[1,""],[0,") {\n    "]],"start1":1607,"start2":1607,"length1":20,"length2":16},{"diffs":[[0,"yString("],[-1,"page"],[0,""],[1,""],[0,");\n\n    "]],"start1":2233,"start2":2233,"length1":20,"length2":16},{"diffs":[[0,"    "],[-1," //alert('received something');"],[0,"\n   "]],"start1":2312,"start2":2312,"length1":39,"length2":8},{"diffs":[[0,";\n      "],[-1,"  "],[-1,"var tableBody = '';"],[0,"\n       "]],"start1":2343,"start2":2343,"length1":37,"length2":16},{"diffs":[[0,"s = "],[-1,"new Array()"],[1,"[]"],[0,";\n  "]],"start1":2375,"start2":2375,"length1":19,"length2":10},{"diffs":[[0,"TypeId, "],[1,"this."],[0,"selectio"]],"start1":2740,"start2":2740,"length1":16,"length2":21},{"diffs":[[0,"PID "],[-1,"+ hidParID"],[0,";\n  "]],"start1":2860,"start2":2860,"length1":18,"length2":8},{"diffs":[[0,"leBody !"],[-1,""],[0,""],[1,"="],[0,"= '') {\n"]],"start1":3536,"start2":3536,"length1":16,"length2":17}]],"length":5100,"saved":false}
