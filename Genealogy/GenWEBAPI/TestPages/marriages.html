<!DOCTYPE html>
<html>
<head>
    <title>Marriage Tests</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
    
    
    <script src="./libs/highlight.pack.js"></script>
    <script src="./libs/testlib.js"></script>
    <script>


        var marriageid;
	
        function getmarriageid() {
		
            var params = {id : 'CEB4A571-B475-4457-8B7B-00B3FD1A131F'};
        
            var url = getUrl() + "marriage?" + $.param(params);
					
            writeLine('URL', url);
		
            $.ajaxSetup({ cache: false });

            $.ajax({
                url: url,
                dataType: "json",
           
                type: "GET",
                success: success,
                error: error,
			
                timeout: 3000000 // sets timeout to 3 seconds
            });
        }

        function getMarriageByFilter(){
		
            var params = {
                uniqref : '',
                malecname : 'george',
                malesname : 'thackray',
                femalecname : '',
                femalesname : '',
                location : '',
                lowerDate : '1700',
                upperDate : '1850',
                sourceFilter : '',
                parishFilter : '',
                marriageWitness : '',
                pno : '0',
                psize : '20',
                sortcol : ''
            };
        
            var url = getUrl() + "filteredmarriages?" + $.param(params);
				 	
            writeLine('URL', url);
		
            $.ajaxSetup({ cache: false });

            $.ajax({
                url: url,
                dataType: "json",
           
                type: "GET",
                success: success,
                error: error,
			
                timeout: 3000000 // sets timeout to 3 seconds
            });
        }

        function addMarriage(finished){
		 
            var marriageWitnesses = []; 
		
            marriageWitnesses.push(
                {
                    name: 'John',
                    surname : 'Smith Witness1',
                    description: 'wit desc 1'
                }
            );
		
            marriageWitnesses.push(
                {
                    name: 'Sarah',
                    surname : 'Smith Witness2',
                    description: 'wit desc 2'
                }
            );
		
		 
            var serviceMarriage = {
                MarriageId : 'CEB4A571-B475-4457-8B7B-00B3FD1A131F',
                MarriageDate : '1 Jan 1800',
                MaleCName : 'George',
                MaleSName : 'Test',
                FemaleCName : 'Sarah',
                FemaleSName : 'Test',
                MaleNotes : 'some male test notes',
                FemaleNotes : 'some female test notes',
                MarriageLocation : 'Grantham',
                LocationId : '69FC0FDA-0885-4B78-A188-0F0866FAF498',
                LocationCounty : 'Lincolnshire',
                MaleLocation : 'Grantham',
                FemaleLocation : 'Sleaford',
                IsBanns : 'true',
                IsLicense : 'false',
                IsWidow : 'false',
                IsWidower : 'true',
                MaleOccupation : 'Male occupation',
                FemaleOccupation : 'Female occupation',
                MaleBirthYear : '1780',
                FemaleBirthYear : '1780',
                SourceDescription : 'source description'
            };	
			
            var serviceMarriageData = {
                serviceMarriage : serviceMarriage,
                sources : 'E54A4328-B1FD-4D13-AB49-00004230CC11',
                marriageWitnesses : marriageWitnesses//JSON.stringify(marriageWitnesses)
            };

            var url = getUrl() + "addmarriage/";

            writeLine('URL', url);
		
            $.ajax({
                url: url,
                dataType: "json",
        
                type: "POST",
                data: serviceMarriageData,
                success: function (xhr, textStatus) {
                    marriageid = xhr;
                    finished(marriageid);
                    success(xhr, textStatus);
                },
                error: error
            });
        }


        function deleteMarriages() {
            var url = getUrl() + "marriage/delete";

            writeLine('URL', url);

            $.ajax({
                url: url,
                dataType: "json",
                type: "POST",
                data: '=' + marriageid,

                success: success,
                error: error
            });
        }

        function setMarriageDuplicate() {
            //marriages/createduplicate
            addMarriage(function(id) {
                var marid1 = id;

                addMarriage(function (id) {
                    var marid2 = id;

                    var url = getUrl() + "marriages/createduplicate";

                    writeLine('URL', url);

                    var param = marid1 + ',' + marid2;

                    $.ajax({
                        url: url,
                        dataType: "json",
                        type: "POST",
                        data: '=' + param,

                        success: function (xhr, textStatus) {
                            //marriageid = xhr;
                            
                            success(xhr, textStatus);
                        },
                        error: error
                    });
                });

            });
        }

        function mergeMarriages() {

        }

        function removeMarriageLinks() {

        }

        function reorderMarriages() {

        }

        function switchSpouses() {

        }



        $(document).ready(function() {
        
            $("#getmarriageid").click(function(e) {
                resetStyling();
                getmarriageid();
                e.preventDefault();
            });
		
            $("#getmarriages").click(function(e) {
                resetStyling();
                getMarriageByFilter();
                e.preventDefault();
            });
			
            $("#addmarriage").click(function(e) {
                resetStyling();
                addMarriage();
                e.preventDefault();
            });			

            $("#deletemarriageid").click(function (e) {
                resetStyling();
                deleteMarriages();
                e.preventDefault();
            });

            $("#marriageduplicatesid").click(function (e) {
                resetStyling();
                setMarriageDuplicate();
                e.preventDefault();
            });

            $("#mergemarriagesid").click(function (e) {
                resetStyling();
                mergeMarriages();
                e.preventDefault();
            });

            $("#removemarriagelinksid").click(function (e) {
                resetStyling();
                removeMarriageLinks();
                e.preventDefault();
            });

            $("#reordermarriagesid").click(function (e) {
                resetStyling();
                reorderMarriages();
                e.preventDefault();
            });

            $("#switchspousesid").click(function (e) {
                resetStyling();
                switchSpouses();
                e.preventDefault();
            });

        });
    </script>

</head>
<body>

<div class="row">
    <div class="col-sm-4" ><a id='getmarriageid' href=''>GetMarriage</a></div>
    <div class="col-sm-4" ><a id='addmarriage' href=''>AddMarriage</a></div>
    <div class="col-sm-4" ><a id='getmarriages' href=''>GetMarriages</a></div>
    
    <div class="col-sm-4"><a id='deletemarriageid' href=''>Delete Marriages</a></div>
    <div class="col-sm-4"><a id='marriageduplicatesid' href=''>Set Marriage Duplicate</a></div>
    <div class="col-sm-4"><a id='mergemarriagesid' href=''>Marge Marriages</a></div>
    
    <div class="col-sm-4"><a id='removemarriagelinksid' href=''>Remove Marriage Links</a></div>
    <div class="col-sm-4"><a id='reordermarriagesid' href=''>Reorder Marriages</a></div>
    <div class="col-sm-4"><a id='switchspousesid' href=''>Switch Spouses</a></div>
</div>

<br/>
<textarea id="result" style="width: 100%; resize: horizontal;"></textarea>
<pre><code id="prettyResult" class="json" style="width: 1024px;"></code></pre>

</body>
</html>


<!--public const string AddMarriage = "addmarriage";
public const string GetMarriages = "marriages";
public const string GetMarriage = "marriage";

public const string DeleteMarriages = "marriage/delete";
public const string SetMarriageDuplicate = "marriages/createduplicate";
public const string MergeMarriages = "marriages/mergemarriages";

        public const string RemoveMarriageLinks = "marriages/removelinks";
        public const string ReorderMarriages = "marriages/reorder";
        public const string SwitchSpouses = "marriages/switchspouses";-->